# markdown-body クラス デザイン刷新仕様書

本ドキュメントでは、`markdown-body` クラスに対するデザイン刷新の設計方針および実装仕様を説明します。

## 目次

1. [改修の背景と目的](#改修の背景と目的)
2. [設計方針](#設計方針)
3. [カラーパレット](#カラーパレット)
4. [タイポグラフィ](#タイポグラフィ)
5. [要素別スタイル仕様](#要素別スタイル仕様)
6. [ダークモード対応](#ダークモード対応)
7. [アクセシビリティ](#アクセシビリティ)
8. [実装ファイル](#実装ファイル)

---

## 改修の背景と目的

既存の `markdown-body` クラスのデザインは機能的であるものの、以下の観点から刷新が必要とされています。

- **視認性の向上**: 本文・見出し・コードブロックのコントラスト比をWCAG AA基準（通常テキスト4.5:1以上）に準拠させる
- **デザインの刷新**: 既存の配色にとらわれず、現代的で読みやすいデザインへ刷新する
- **ダークモード対応**: 既存のダークモード切替機構（`.dark` クラス）をそのまま利用しつつ、ダークモードでの視認性を改善する
- **一貫性の確保**: 見出し・本文・引用・コード・表など各要素間のビジュアル階層を明確にする

---

## 設計方針

### 1. 視認性最優先

- すべてのテキストとその背景のコントラスト比をWCAG AA以上に保つ
- 見出しの階層（H1〜H6）をフォントサイズ・色・区切り線で視覚的に明確化する

### 2. 配色の刷新

- **ライトモード**: スレート系（青みがかったグレー）をベースに、アクセントカラーとしてブルーを使用する
- **ダークモード**: 深い紺色系の背景を想定した、明るく読みやすい前景色を使用する

### 3. 既存ダークモード機構の活用

ダークモードの切替には、既存の仕組み（`DarkModeProvider` による `.dark` クラスの付与）をそのまま活用します。  
CSSでは `.dark .markdown-body` セレクタでダークモード用スタイルを上書きします。

### 4. コードブロックの強調

- インラインコードとコードブロック（`pre`）を視覚的に明確に区別する
- コードブロックはダーク背景を採用し、シンタックスハイライトとの親和性を高める
- ライトモードでも同様にダーク背景のコードブロックを使用することで、コンテンツとの差別化を図る

---

## カラーパレット

### ライトモード

| 用途 | 色名 | カラーコード |
|------|------|-------------|
| 本文テキスト | Slate 700 | `#334155` |
| 見出し（H1/H2） | Slate 900 | `#0f172a` |
| 見出し（H3） | Slate 800 | `#1e293b` |
| H2 区切り線 | Slate 200 | `#e2e8f0` |
| リンク | Blue 600 | `#2563eb` |
| リンク（ホバー） | Blue 800 | `#1e40af` |
| 引用ボーダー | Blue 500 | `#3b82f6` |
| 引用背景 | Blue 50 | `#eff6ff` |
| 引用テキスト | Slate 600 | `#475569` |
| インラインコード背景 | Slate 100 | `#f1f5f9` |
| インラインコードテキスト | Rose 700 | `#be123c` |
| コードブロック背景 | Slate 900 | `#0f172a` |
| コードブロックテキスト | Slate 200 | `#e2e8f0` |
| テーブルヘッダー背景 | Slate 100 | `#f1f5f9` |
| テーブルボーダー | Slate 200 | `#e2e8f0` |
| HR | Slate 200 | `#e2e8f0` |

### ダークモード

| 用途 | 色名 | カラーコード |
|------|------|-------------|
| 本文テキスト | Slate 300 | `#cbd5e1` |
| 見出し（H1/H2/H3） | Slate 50 | `#f8fafc` |
| H2 区切り線 | Slate 700 | `#334155` |
| リンク | Blue 400 | `#60a5fa` |
| リンク（ホバー） | Blue 300 | `#93c5fd` |
| 引用ボーダー | Blue 500 | `#3b82f6` |
| 引用背景 | Blue 900 (透過) | `rgba(30, 58, 138, 0.3)` |
| 引用テキスト | Slate 400 | `#94a3b8` |
| インラインコード背景 | Slate 800 | `#1e293b` |
| インラインコードテキスト | Rose 400 | `#fb7185` |
| コードブロック背景 | Slate 950 | `#020617` |
| コードブロックテキスト | Slate 200 | `#e2e8f0` |
| テーブルヘッダー背景 | Slate 800 | `#1e293b` |
| テーブルボーダー | Slate 700 | `#334155` |
| HR | Slate 700 | `#334155` |

---

## タイポグラフィ

### フォントファミリー

```
font-family: 'Segoe UI', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif;
```

日本語フォントへのフォールバックを含む、可読性の高いサンセリフフォントスタックを使用します。

### 文字サイズ・行間

| 要素 | フォントサイズ | フォントウェイト | 行間 |
|------|--------------|---------------|------|
| 本文 | 1.05rem | 400 | 1.85 |
| H1 | 2.4rem | 800 | 1.2 |
| H2 | 1.75rem | 700 | 1.25 |
| H3 | 1.35rem | 600 | 1.35 |
| H4〜H6 | - | 600 | - |
| コード（インライン） | 0.95em | - | - |
| コードブロック | 0.95rem | - | - |

---

## 要素別スタイル仕様

### 見出し（H1〜H6）

- **H1**: 最大フォントサイズ（2.4rem）、太字（800）、上下余白あり
- **H2**: やや小さく（1.75rem）、太字（700）、下部に区切り線
- **H3**: 中程度（1.35rem）、セミボールド（600）
- **H4〜H6**: セミボールド（600）、段階的に小さくなる余白

### 段落

- 行間 1.85 で読みやすさを確保
- 上下マージン 1.1em

### リンク

- デフォルトで下線あり
- ホバー時に色が変化（トランジション 0.15s）
- `word-break: break-all` で長いURLが崩れないよう対応

### リスト

- 通常リスト: 左に 2em のインデント
- タスクリスト: `list-style: none`、チェックボックスを `0.5em` の間隔で配置

### 引用（blockquote）

- 左ボーダー（4px）で視覚的に強調
- 背景色で引用エリアを明示
- イタリック体
- 角丸（0.4em）で柔らかい印象に

### インラインコード（`code`）

- 背景色でコードを強調
- テキスト色を変えて本文と区別

### コードブロック（`pre`）

- **ライト・ダーク共通**でダーク背景（Slate 900 / Slate 950）を採用
- 水平スクロール対応（`overflow-x: auto`）
- 角丸（0.6em）と余白（1.2em）で視認性を確保
- `pre` 内の `code` はリセット（背景・色・パディングなし）

### テーブル

- 全幅、ボーダー付き（`border-collapse: collapse`）
- ヘッダー行は背景色で強調
- セルに適切な余白（0.65em 1em）

### 水平線（hr）

- ボーダーのみ、マージン 2.5em

### 画像

- 最大幅 100%（レスポンシブ対応）
- 角丸（0.4em）
- 上下マージン 1.2em

---

## ダークモード対応

既存の `.dark` クラスベースのダークモード機構を使用します。

```css
/* ライトモード（デフォルト） */
.markdown-body { ... }

/* ダークモード（.dark クラスが html に付与されたとき） */
.dark .markdown-body { ... }
```

`globals.css` の `@custom-variant dark (&:where(.dark, .dark *));` の仕組みは変更せず、既存の `.dark .markdown-body` セレクタパターンを継続して利用します。

---

## アクセシビリティ

### コントラスト比（WCAG AA 基準）

| 組み合わせ | モード | コントラスト比 |
|-----------|------|--------------|
| 本文テキスト `#334155` / 白背景 `#ffffff` | ライト | 約 9.7:1 ✅ |
| H1 `#0f172a` / 白背景 `#ffffff` | ライト | 約 18.1:1 ✅ |
| リンク `#2563eb` / 白背景 `#ffffff` | ライト | 約 5.9:1 ✅ |
| 本文テキスト `#cbd5e1` / 背景 `#0a0a0a` | ダーク | 約 11.5:1 ✅ |
| H1 `#f8fafc` / 背景 `#0a0a0a` | ダーク | 約 18.7:1 ✅ |
| リンク `#60a5fa` / 背景 `#0a0a0a` | ダーク | 約 7.1:1 ✅ |

---

## 実装ファイル

| ファイル | 変更内容 |
|---------|---------|
| `src/app/globals.css` | `markdown-body` クラスおよびダークモード用スタイルを刷新 |
